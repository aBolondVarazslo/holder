$logPath = "C:\Users\Public\log.txt"

function main {
    if (Test-Path $logPath) {
        Write-Output "Script already ran"
    }

    else {
        Start-Process "calc.exe"
        Start-Sleep -Seconds 1

        "Executed at: $(Get-Date)" | Out-File -FilePath $logPath
        Write-Output "Script executed and logged."
    }
}

main
